<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Orçamento #<%= @orcamento.cod_orcamento %></title>
    <style>
      body { font-family: Arial, sans-serif; margin: 20px; }
      .header { text-align: center; margin-bottom: 30px; }
      .info { margin-bottom: 20px; }
      .info-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
      table { width: 100%; border-collapse: collapse; margin: 20px 0; }
      th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
      th { background-color: #f2f2f2; }
      .total { text-align: right; font-weight: bold; }
      .footer { margin-top: 50px; }
      .signature { margin-top: 80px; border-top: 1px solid #000; width: 300px; text-align: center; }
      @media print {
        @page {
          size: A4 portrait; /* ou landscape */
          <%# margin: 20mm; %>
        }
        .no-print { display: none; }
      }
    </style>
  </head>
  <body>
    <div class="no-print" style="margin-bottom: 20px;">
      <button onclick="window.print()">Imprimir</button>
      <button onclick="window.close()">Fechar</button>
    </div>
    <div class="header">
      <h2><%= @orcamento.empresa.nome %></h2>
      <%# <p>CNPJ: <%= @orcamento.empresa.cpf_cnpj % ></p> %>
      <p>Endereço: <%= @orcamento.empresa.pessoa.endereco %>, <%= @orcamento.empresa.pessoa.numero %></p>
      <p>Telefone: <%= @orcamento.empresa.pessoa.telefone %>, Celular: <%= @orcamento.empresa.pessoa.celular %></p>
      <h3>ORÇAMENTO Nº <%= @orcamento.cod_orcamento %></h3>
    </div>
    <div class="info">
      <div class="info-row">
        <div><strong>Cliente:</strong> <%= @orcamento.pessoa.nome %></div>
        <div><strong>Data:</strong> <%= l(@orcamento.data_orcamento, format: :short) %></div>
      </div>
      <div class="info-row">
        <div><strong>CPF/CNPJ:</strong> <%= @orcamento.pessoa.cpf_cnpj %></div>
        <div><strong>Validade:</strong> <%= @orcamento.data_validade ? l(@orcamento.data_validade) : 'Não definida' %></div>
      </div>
      <div class="info-row">
        <div><strong>Telefone:</strong> <%= @orcamento.pessoa.telefone || @orcamento.pessoa.celular %></div>
        <div><strong>Vendedor:</strong> <%= @orcamento.funcionario.usuario %></div>
      </div>
    </div>
    <% if @orcamento.observacoes.present? %>
      <div style="margin-bottom: 20px;">
        <strong>Observações:</strong> <%= @orcamento.observacoes %>
      </div>
    <% end %>
    <table>
      <thead>
        <tr>
          <th>Produto</th>
          <th>Cor</th>
          <th style="width: 80px;">Qtd</th>
          <th style="width: 100px;">Valor Unit.</th>
          <th style="width: 100px;">Total</th>
        </tr>
      </thead>
      <tbody>
        <% @orcamento.itens_orcamentos.each do |item| %>
          <tr>
            <td><%= item.produto.nome %></td>
            <td><%= item.cor&.nmcor || '-' %></td>
            <td style="text-align: center;"><%= number_with_precision(item.quantidade, precision: 0) %></td>
            <td style="text-align: right;"><%= number_to_currency(item.valorunitario) %></td>
            <td style="text-align: right;"><%= number_to_currency(item.valor_total) %></td>
          </tr>
        <% end %>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="4" class="total">TOTAL:</td>
          <td style="text-align: right; font-weight: bold;"><%= number_to_currency(@orcamento.valortotal) %></td>
        </tr>
      </tfoot>
    </table>
    <div class="footer">
      <p><strong>Forma de Pagamento:</strong> A combinar</p>
      <p style="font-size: 12px;">Este orçamento tem validade até <%= @orcamento.data_validade ? l(@orcamento.data_validade) : '____/____/________' %></p>
      <div style="margin-top: 60px;">
        <div class="signature" style="display: inline-block; margin-right: 50px;">
          <p>Assinatura do Cliente</p>
        </div>
        <div class="signature" style="display: inline-block;">
          <p>Assinatura do Vendedor</p>
        </div>
      </div>
    </div>
  </body>
</html>
