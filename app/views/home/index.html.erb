<!-- Hero Section com imagem de fundo -->
<section class="hero-section">
  <div class="container text-center">
    <h1 class="display-3 fw-bold mb-4">M√≥veis Rosa Store</h1>
    <p class="lead mb-5">H√° 30 anos transformando casas em lares com m√≥veis e decora√ß√£o de qualidade</p>
    <a href="#equipe" class="btn btn-primary btn-lg">Fale Conosco</a>
  </div>
</section>
<!-- Sobre N√≥s Section -->
<section id="sobre" class="py-5">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6 mb-4 mb-lg-0">
        <img src="/images/sobre_loja.jpeg" alt="Sobre N√≥s" class="img-fluid rounded shadow">
      </div>
      <div class="col-lg-6">
        <h2 class="section-title text-start">Sobre Nossa Empresa</h2>
        <p class="mb-4">M√≥veis Rosa Store √© sin√¥nimo de tradi√ß√£o, qualidade e bom gosto. Desde 1996, levamos m√≥veis e decora√ß√µes que transformam ambientes e realizam sonhos. <br>
          <br>
          S√£o quase 30 anos de hist√≥ria, sempre com o compromisso de oferecer produtos de excel√™ncia e atendimento de confian√ßa.
          Com seis lojas localizadas nas cidades de Toledo, Marechal C√¢ndido Rondon, Nova Santa Rosa, Marip√°, Porto Mendes e Assis, seguimos crescendo com voc√™, valorizando cada detalhe que faz da sua casa um verdadeiro lar.</p>
        <div class="row mt-4">
          <div class="col-md-6 mb-3">
            <div class="d-flex align-items-center">
              <i class="fas fa-check-circle text-dark me-3 fs-4"></i>
              <div>
                <h5 class="mb-1">Qualidade</h5>
                <p class="mb-0 text-muted">Produtos de excel√™ncia</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="d-flex align-items-center">
              <i class="fas fa-headset text-dark me-3 fs-4"></i>
              <div>
                <h5 class="mb-1">Suporte</h5>
                <p class="mb-0 text-muted">Atendimento personalizado</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="d-flex align-items-center">
              <i class="fas fa-rocket text-dark me-3 fs-4"></i>
              <div>
                <h5 class="mb-1">Inova√ß√£o</h5>
                <p class="mb-0 text-muted">Solu√ß√µes modernas</p>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="d-flex align-items-center">
              <i class="fas fa-shield-alt text-dark me-3 fs-4"></i>
              <div>
                <h5 class="mb-1">Confian√ßa</h5>
                <p class="mb-0 text-muted">Seguran√ßa garantida</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Miss√£o, Vis√£o e Valores Section -->
<section id="missao-visao-valores" class="py-5 bg-light">
  <div class="container">
    <h2 class="section-title text-center mb-5">Miss√£o, Vis√£o e Valores</h2>
    <div class="row mb-5">
      <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm">
          <div class="card-body text-center p-4">
            <div class="rounded-circle bg-dark text-white d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 80px; height: 80px;">
              <i class="fas fa-bullseye fa-2x"></i>
            </div>
            <h3 class="card-title h4 mb-3 text-danger">Miss√£o</h3>
            <p class="card-text">Transformar lares e vidas com m√≥veis de qualidade, criando ambientes acolhedores que inspiram conforto e bem estar a fam√≠lia.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm">
          <div class="card-body text-center p-4">
            <div class="rounded-circle bg-dark text-white d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 80px; height: 80px;">
              <i class="fas fa-eye fa-2x"></i>
            </div>
            <h3 class="card-title h4 mb-3 text-danger">Vis√£o</h3>
            <p class="card-text">Ser reconhecida como a melhor loja no segmento de m√≥veis na regi√£o de atua√ß√£o. Vis√£o at√© 2027.</p>
            <p class="card-text"><strong>Entrega extraordin√°ria:</strong> Proporcionar uma experi√™ncia √∫nica e encantadora ao cliente.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm">
          <div class="card-body text-center p-4">
            <div class="rounded-circle bg-dark text-white d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 80px; height: 80px;">
              <i class="fas fa-heart fa-2x"></i>
            </div>
            <h3 class="card-title h4 mb-3 text-danger">Valores</h3>
            <ul class="list-unstyled text-start">
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>Honestidade:</strong> Agir com base na verdade de forma √©tica, sem enganar ou omitir.</li>
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>Compromisso com o lar do cliente:</strong> Cada m√≥vel entregue √© parte de um sonho realizado.</li>
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>Esp√≠rito de colabora√ß√£o:</strong> Trabalhar em equipe afim de buscar solu√ß√µes e objetivos comuns.</li>
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>Respeito:</strong> Tratar ao pr√≥ximo com dignidade, empatia e considera√ß√£o.</li>
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>F√©:</strong> Acreditar no extraordin√°rio.</li>
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>Desenvolvimento cont√≠nuo:</strong> Buscar constantemente o aprimoramento pessoal e profissional.</li>
              <li class="mb-2"><i class="fas fa-check-circle text-dark me-2"></i> <strong>Autorresponsabilidade:</strong> Assumir a responsabilidade pelas pr√≥prias a√ß√µes, decis√µes e resultados.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Produtos Section -->
<section id="produtos" class="py-5 bg-light">
  <div class="container">
    <h2 class="section-title text-center">Nossos Produtos</h2>
    <p class="text-center mb-3">Conhe√ßa nossa linha exclusiva de m√≥veis e decora√ß√£o para sua casa</p>
    <div class="text-center mb-5">
      <a href="<%= portfolio_path %>" class="btn btn-outline-primary">
        <i class="fas fa-th me-2"></i>Ver Todos os Produtos
      </a>
    </div>
    <div class="row justify-content-center">
      <% if @produtos.present? %>
        <% @produtos.each do |produto| %>
          <% produto.produto_imagens.group_by(&:cod_cor).each do |cod_cor, imagens| %>
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="text-center p-3">
                  <% if imagens.count > 1 %>
                    <div id="carousel<%= produto.cod_produto %>_<%= cod_cor %>" class="carousel slide" data-bs-ride="carousel">
                      <div class="carousel-inner">
                        <% imagens.each_with_index do |imagem, index| %>
                          <div class="carousel-item <%= 'active' if index == 0 %>">
                            <%= image_tag(imagem.imagem.variant(resize_to_limit: [220, 180]),
                                  class: "rounded mx-auto d-block", 
                                  style: "max-width: 220px; height: 180px; object-fit: contain; cursor: zoom-in;",
                                  data: { images: imagens.map{|img| url_for(img.imagem)}.to_json.html_safe, index: index },
                                  ondblclick: "openImageModal(this)" 
                                ) %>
                          </div>
                        <% end %>
                      </div>
                      <button class="carousel-control-prev" type="button" data-bs-target="#carousel<%= produto.cod_produto %>_<%= cod_cor %>" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true" style="filter: invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);"></span>
                      </button>
                      <button class="carousel-control-next" type="button" data-bs-target="#carousel<%= produto.cod_produto %>_<%= cod_cor %>" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true" style="filter: invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);"></span>
                      </button>
                    </div>
                  <% else %>
                    <%= image_tag(imagens.first.imagem.variant(resize_to_limit: [220, 180]),
                          class: "rounded mx-auto d-block", 
                          style: "max-width: 220px; height: 180px; object-fit: contain; cursor: zoom-in;",
                          data: { images: imagens.map{|img| url_for(img.imagem)}.to_json.html_safe, index: 0 },
                          ondblclick: "openImageModal(this)" 
                        ) %>
                  <% end %>
                </div>
                <div class="card-body">
                  <h5 class="card-title">
                    <p class="card-text"><%= truncate(produto.titulo&.capitalize, length: 50) %></p>
                  </h5>
                  <div class="card-text">
                    <span id="desc-short-<%= produto.cod_produto %>_<%= cod_cor %>"><%= simple_format(truncate(produto.descricao&.capitalize, length: 100)) %></span>
                    <span id="desc-full-<%= produto.cod_produto %>_<%= cod_cor %>" style="display: none;"><%= simple_format(produto.descricao&.capitalize) %></span>
                    <% if produto.descricao&.length.to_i > 100 %>
                      <a href="#" class="text-primary" onclick="toggleDescription('<%= produto.cod_produto %>_<%= cod_cor %>')" id="toggle-<%= produto.cod_produto %>_<%= cod_cor %>">...mais</a>
                    <% end %>
                  </div>
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="text-success fw-bold">R$ <%= number_to_currency(produto.valor_site_por_cor(cod_cor), unit: "") %></span>
                    <% produto_url = produto_url(produto.cod_produto, cod_cor) %>
                    <button type="button" 
                          class="btn btn-primary" 
                          data-bs-toggle="modal" 
                          data-bs-target="#lojaModal<%= produto.cod_produto %>_<%= cod_cor %>"
                          data-produto-url="<%= produto_url %>">
                      Tenho interesse
                    </button>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      <% else %>
        <div class="col-12 text-center">
          <p>Nenhum produto dispon√≠vel no momento.</p>
        </div>
      <% end %>
    </div>
  </div>
</section>
<!-- Modais dos produtos (renderizados para cada cor) -->
<% if @produtos.present? %>
  <% @produtos.each do |produto| %>
    <% produto.produto_imagens.group_by(&:cod_cor).each do |cod_cor, imagens| %>
      <%= render partial: 'home/shared/whatsapp_modal', locals: { produto: produto, cod_cor: cod_cor, modal_id: "lojaModal#{produto.cod_produto}_#{cod_cor}" } %>
    <% end %>
  <% end %>
<% end %>
<!-- Equipe Section -->
<section id="equipe" class="py-5">
  <div class="container">
    <h2 class="section-title text-center">Fale Conosco</h2>
    <p class="text-center mb-5">Conhe√ßa os profissionais que fazem a diferen√ßa</p>
    <div class="swiper-container">
      <div class="swiper-wrapper">
        <% (@colaboradores * 2).each do |colab| %>
          <div class="swiper-slide">
            <div class="card text-center h-100">
              <div class="p-3">
                <% if colab.photo.attached? %>
                  <%= image_tag url_for(colab.photo), class: "rounded-circle img-fluid mx-auto", style: "width: 150px; height: 150px; object-fit: cover;" %>
                <% else %>
                  <img src="/images/mrosa.png" class="rounded-circle img-fluid mx-auto" style="width: 150px; height: 150px; object-fit: cover;">
                <% end %>
              </div>
              <div class="card-body">
                <h5 class="card-title mb-1"><%= colab.display_name %></h5>
                <p class="text-muted mb-3"><%= colab.funcionario.funcao rescue "Atendimento" %></p>
                <% mensagem = "Ol√° " + colab.display_name&.capitalize + "! üëã Tenho interesse em comprar um produto da sua loja. Pode me ajudar?" %>
                <% url_whatsapp = "https://wa.me/#{colab.whatsapp_number.gsub(/\D/, "")}?text=#{URI.encode_www_form_component(mensagem)}" %>
                <a href="<%= url_whatsapp %>" class="btn btn-success btn-sm me-2" target="_blank">
                  <i class="fab fa-whatsapp me-1"></i> WhatsApp
                </a>
                <% contato = colab.email.present? ? colab.email : 'contato@moveisrosastore.com' %>
                <% is_instagram = contato.start_with?("http://", "https://") && contato.include?("instagram.com") %>
                <a href="<%= is_instagram ? contato : "mailto:#{contato}" %>" target="_blank" class="btn btn-sm <%= is_instagram ? 'btn-instagram' : 'btn-outline-primary' %>">
                  <% if is_instagram %>
                    <i class="fab fa-instagram me-1"></i> Instagram
                  <% else %>
                    <i class="fas fa-envelope me-1"></i> Email
                  <% end %>
                </a>
              </div>
            </div>
          </div>
        <% end %>
      </div>
      <!-- Navigation -->
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
  </div>
</section>
<!-- Modal para ampliar imagem -->
<%= render partial: 'home/shared/image_modal' %>
<!-- Swiper CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
  new Swiper(".swiper-container", {
    slidesPerView: 3,
    spaceBetween: 5,
    slidesPerGroup: 1,
    loop: true,
    autoplay: {
      delay: 3000,
      disableOnInteraction: true,
    },
    speed: 700,
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
    breakpoints: {
      992: { slidesPerView: 3, spaceBetween: 5 },
      768: { slidesPerView: 2, spaceBetween: 5 },
      0:   { slidesPerView: 1, spaceBetween: 5 },
    },
    on: {
      reachEnd: function () {
        this.slideTo(0, 0);
        this.autoplay.start();
      }
    }
  });
  });


  function toggleDescription(id) {
    const shortDesc = document.getElementById('desc-short-' + id);
    const fullDesc = document.getElementById('desc-full-' + id);
    const toggle = document.getElementById('toggle-' + id);

    if (shortDesc.style.display === 'none') {
      shortDesc.style.display = 'inline';
      fullDesc.style.display = 'none';
      toggle.textContent = '...mais';
    } else {
      shortDesc.style.display = 'none';
      fullDesc.style.display = 'inline';
      toggle.textContent = ' menos';
    }
  }
</script>
<style>
  .card-text p:first-letter {
    text-transform: uppercase;
  }
  .swiper-container {
    width: 100%;
    padding-bottom: 30px;
    overflow: hidden;
    position: relative;
  }
  .swiper-slide {
    display: flex;
    justify-content: center;
    width: auto;
  }
  .swiper-slide .card {
    width: 100%;
    max-width: 300px;
  }
  .swiper-button-next,
  .swiper-button-prev {
    color: #17a2b8;
    margin-top: 0;
    top: 50%;
    transform: translateY(-50%);
  }
  .swiper-button-next:after,
  .swiper-button-prev:after {
    font-size: 20px;
    font-weight: bold;
  }
  .btn-instagram {
  background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
  color: white;
  border: none;
  }

  .btn-instagram:hover {
  opacity: 0.9;
  color: white;
  }
</style>